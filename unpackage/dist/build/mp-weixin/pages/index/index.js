(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"3fd2":function(o,e,t){"use strict";t.r(e);var n=t("500a"),s=t.n(n);for(var c in n)["default"].indexOf(c)<0&&function(o){t.d(e,o,(function(){return n[o]}))}(c);e["default"]=s.a},"500a":function(o,e,t){"use strict";(function(o,n){var s=t("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;t("11c1");var c=t("15f2"),i=t("4f67"),l=(t("26cb"),s(t("268f"))),a="smartwater/sub",u={components:{takemo:function(){Promise.all([t.e("common/vendor"),t.e("components/takemo")]).then(function(){return resolve(t("d826"))}.bind(null,t)).catch(t.oe)}},data:function(){return{client:{},Height:"0",Height1:"0",flow:"0",Beep:0,Pump:0,Pump1:0,DZF:0,DZF1:0,ZW_Led:0,UserName:"xx",PH:"xx",temp:"xx",TDS:"xx",password:"xx",Device_ID:"0",net:"离线",net_flag:0,ID:"xx",surplus:"0",total:"0",time:"0",Bottle:"0",logs:[],topic:"presence",isRed:!1,showPop:!1,shuju:"11",showDialog:!1,inputValue:"200"}},mounted:function(){},computed:{},methods:{confirm:function(){console.log(this.inputValue+""),this.showDialog=!1;var e=parseInt(this.inputValue),t='{"target":"cap","value":'+e+"}";this.client.publish(a,t,(function(o){o||(console.log("=====自选下单===="),console.log(t))})),o.showToast({title:"下单成功!",icon:"none"})},cancel:function(){this.inputValue="",this.showDialog=!1},formSubmit:function(e){console.log("form发生了submit事件，携带数据为："+JSON.stringify(e.detail.value));var t=e.detail.value,n=l.default.check(t,[{name:"cap",checkType:"in",checkRule:"100,200,300,400,500",errorMsg:"请选择容量"}]),s=e.detail.value.cap;if(n){var c='{"target":"cap","value":'+s+"}";this.client.publish(a,c,(function(o){o||(console.log("=====自选下单===="),console.log(c))})),o.showToast({title:"下单成功!",icon:"none"})}else o.showToast({title:l.default.error,icon:"none"})},formReset:function(o){console.log("清空数据")},confirmPop:function(){this.showPop=!1;var e=this;console.log(this.shuju);var t=this.shuju;e.shuju?o.showModal({title:"提示",content:"成功",showCancel:!1,success:function(o){if(o.confirm){console.log("用户下单成功");var s='{"target":"cap","value":'+t+"}";e.client.publish(a,s,(function(o){o?n.showToast({title:"下发异常",icon:"error",mask:!1}):(n.showToast({title:"指令下发成功",icon:"success",mask:!0}),console.log(s))}))}}}):o.showModal({title:"提示",content:"不能为NULL",showCancel:!1,success:function(o){o.confirm&&console.log("用户点击确定")}})},cancelPop:function(){console.log("点击了取消"),this.showPop=!1},onChange:function(o,e,t){console.log(o.mp.detail);var s=o.mp.detail.value;var c=s?1:0,i='{"target":"'+e+'","value":'+c+"}";this.client.publish(a,i,(function(o){o?n.showToast({title:"下发异常",icon:"error",mask:!1}):(s?(console.log("成功下发命令——打开报警器"),console.log(i)):(console.log("成功下发命令——关闭报警器"),console.log(i)),n.showToast({title:"指令下发成功",icon:"success",mask:!0}))}))},onBotton:function(o,e,t){var s=this.UserName,c='{"target":"'+e+'","name":"'+s+'","value":'+t+"}";console.log(o.mp.detail);this.client.publish(a,c,(function(o){o||(console.log("成功下发命令:"+e),console.log(c),n.showToast({title:"指令下发成功",icon:"success",mask:!0}))}))},test:function(){n.showToast({title:"开发中。。",icon:"error",mask:!1})},getwater:function(){this.showPop=!0}},onShow:function(){var o=this;n.showToast({title:"连接服务器....",icon:"loading",duration:1e4,mask:!0});var e=10,t=setInterval((function(){e--,e?n.showToast({title:"连接服务器...".concat(e),icon:"loading",duration:1e3,mask:!0}):(clearInterval(t),n.showToast({title:"连接失败",icon:"error",mask:!0}))}),1e3);c.MQTT_OPTIONS.clientId=(new Date).getTime(),o.client=(0,i.connect)("wxs://"+c.MQTT_IP,c.MQTT_OPTIONS),o.client.on("connect",(function(){console.log("成功连接mqtt服务器！"),clearInterval(t),n.showToast({title:"连接成功",icon:"success",mask:!0}),setTimeout((function(){o.client.subscribe("smartwater/pub",(function(o){o||(console.log("成功订阅设备上行数据Topic!"),n.showToast({title:"订阅成功",icon:"success",mask:!0}))}))}),1e3)})),o.client.on("message",(function(e,t){console.log(e),console.log(t);var n;n=JSON.parse(t),console.log(n),o.Height=n.Height,o.Height1=n.Height1,0==n.Flow&&(o.flow=n.Flow1),o.flow=n.Flow,o.Device_ID=n.devicd_id,o.ID=n.user_id,o.UserName=n.user_name,o.surplus=n.user_money,o.password=n.user_password,o.Pump=n.Pump,o.Pump1=n.Pump1,o.net_flag=n.status,0!=o.net_flag&&(o.net="在线"),o.PH=n.ph,o.TDS=n.tds,o.temp=n.Temp,o.DZF=n.DZF,o.DZF1=n.DZF1,o.ZW_Led=n.ZW_LED,o.Bottle=n.Bottle,o.Beep=n.BEEP,o.time=n.time}))}};e.default=u}).call(this,t("543d")["default"],t("bc2e")["default"])},"6db2":function(o,e,t){"use strict";(function(o,e){var n=t("4ea4");t("4958");n(t("66fd"));var s=n(t("b8c0"));o.__webpack_require_UNI_MP_PLUGIN__=t,e(s.default)}).call(this,t("bc2e")["default"],t("543d")["createPage"])},7869:function(o,e,t){"use strict";var n=t("a5c1"),s=t.n(n);s.a},a5c1:function(o,e,t){},b8c0:function(o,e,t){"use strict";t.r(e);var n=t("b8fb"),s=t("3fd2");for(var c in s)["default"].indexOf(c)<0&&function(o){t.d(e,o,(function(){return s[o]}))}(c);t("7869");var i=t("f0c5"),l=Object(i["a"])(s["default"],n["b"],n["c"],!1,null,"55f69ce1",null,!1,n["a"],void 0);e["default"]=l.exports},b8fb:function(o,e,t){"use strict";t.d(e,"b",(function(){return n})),t.d(e,"c",(function(){return s})),t.d(e,"a",(function(){}));var n=function(){var o=this,e=o.$createElement;o._self._c;o._isMounted||(o.e0=function(e){o.showDialog=!0})},s=[]}},[["6db2","common/runtime","common/vendor"]]]);